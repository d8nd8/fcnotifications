{% extends "unfold/layouts/base_simple.html" %}
{% load i18n unfold static %}

{% block breadcrumbs %}{% endblock %}

{% block title %}
    {% trans 'Dashboard' %} | –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
{% endblock %}

{% block branding %}
{% endblock %}

{% block content %}
<div class="container mx-auto py-8">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
            {{ title|default:"–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è" }}
        </h1>
        <p class="text-gray-600 dark:text-gray-400">
            {{ subtitle|default:"–°–µ—Ä–≤–∏—Å –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤" }}
        </p>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div class="grid gap-6 mb-8" style="grid-template-columns: repeat(3, 1fr);">
        <!-- –í—Å–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-blue-500 rounded-md flex items-center justify-center">
                        <span class="text-white text-lg">üì±</span>
                    </div>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">–í—Å–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</p>
                    <p class="text-3xl font-semibold text-gray-900 dark:text-white">{{ devices_total|default:0 }}</p>
                </div>
            </div>
        </div>

        <!-- –û–Ω–ª–∞–π–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-green-500 rounded-md flex items-center justify-center">
                        <span class="text-white text-lg">üü¢</span>
                    </div>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">–û–Ω–ª–∞–π–Ω</p>
                    <p class="text-3xl font-semibold text-gray-900 dark:text-white">{{ devices_online|default:0 }}</p>
                </div>
            </div>
        </div>

        <!-- –û—Ñ–ª–∞–π–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-red-500 rounded-md flex items-center justify-center">
                        <span class="text-white text-lg">üî¥</span>
                    </div>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">–û—Ñ–ª–∞–π–Ω</p>
                    <p class="text-3xl font-semibold text-gray-900 dark:text-white">{{ devices_offline|default:0 }}</p>
                </div>
            </div>
        </div>

        <!-- –ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥ -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-yellow-500 rounded-md flex items-center justify-center">
                        <span class="text-white text-lg">‚ö†Ô∏è</span>
                    </div>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">–ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥</p>
                    <p class="text-3xl font-semibold text-gray-900 dark:text-white">{{ low_battery_count|default:0 }}</p>
                </div>
            </div>
        </div>

        <!-- –ó–∞—Ä—è–∂–∞–µ—Ç—Å—è -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-orange-500 rounded-md flex items-center justify-center">
                        <span class="text-white text-lg">üîå</span>
                    </div>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">–ó–∞—Ä—è–∂–∞–µ—Ç—Å—è</p>
                    <p class="text-3xl font-semibold text-gray-900 dark:text-white">{{ charging_devices|default:0 }}</p>
                </div>
            </div>
        </div>

        <!-- –ï—Å—Ç—å —Å–µ—Ç—å -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-indigo-500 rounded-md flex items-center justify-center">
                        <span class="text-white text-lg">üåê</span>
                    </div>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">–ï—Å—Ç—å —Å–µ—Ç—å</p>
                    <p class="text-3xl font-semibold text-gray-900 dark:text-white">{{ devices_with_network|default:0 }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-purple-500 rounded-xl flex items-center justify-center">
                    <span class="text-white text-xl">üí¨</span>
                </div>
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è</h3>
            </div>
            <a href="{% url 'admin:devices_message_changelist' %}" 
               class="px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white text-sm font-medium rounded-xl shadow-md hover:shadow-lg transition-all duration-200 flex items-center gap-2">
                <span>–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
                <span class="text-lg">‚Üí</span>
            </a>
        </div>
        <div class="overflow-hidden rounded-xl border border-gray-200 dark:border-gray-700">
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead>
                        <tr class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900">
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                <div class="flex items-center gap-2">
                                    <span>üì±</span>
                                    <span>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</span>
                                </div>
                            </th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                <div class="flex items-center gap-2">
                                    <span>üïê</span>
                                    <span>–í—Ä–µ–º—è</span>
                                </div>
                            </th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                <div class="flex items-center gap-2">
                                    <span>üë§</span>
                                    <span>–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å</span>
                                </div>
                            </th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                <div class="flex items-center gap-2">
                                    <span>üí¨</span>
                                    <span>–°–æ–æ–±—â–µ–Ω–∏–µ</span>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-100 dark:divide-gray-700">
                        {% if recent_messages %}
                            {% for m in recent_messages %}
                            <tr class="hover:bg-purple-50/50 dark:hover:bg-purple-900/10 transition-colors duration-150">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <div class="text-sm font-semibold text-gray-900 dark:text-white">{{ m.device_name }}</div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-600 dark:text-gray-400 font-mono">{{ m.date_created|date:"d.m.Y H:i" }}</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center gap-2">
                                        <span class="px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 text-xs font-medium rounded-full">
                                            {{ m.sender }}
                                        </span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-700 dark:text-gray-200 max-w-xl truncate">{{ m.text }}</div>
                                </td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td class="px-6 py-12 text-center" colspan="4">
                                    <div class="flex flex-col items-center justify-center gap-2">
                                        <span class="text-4xl">üì≠</span>
                                        <p class="text-sm text-gray-500 dark:text-gray-400 font-medium">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                                    </div>
                                </td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    
</div>
{% endblock %}
